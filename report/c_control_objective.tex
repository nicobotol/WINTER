\section{WT controllers and their objectives} \label{sec:control_objective}
This section of the work gives an overview of the different controllers present in a WT and their motivation. First of all, it is highlighted that the controllers act on different time scales and so they are stacked in multiple hierarchical levels. In a second part, the different standard operating regions of a WT are presented. These are wind ranges in which the turbine is controlled to extract the power in a specific way, and are usually defined according to the maximum power that can be extracted with respect to the nominal. In the third part, three approaches to implement the power limitations are described. Finally the yaw and electrical generator controllers are briefly discussed. The former will not be taken into account in the thesis, while the latter will be deeply studied in following sections of the work.  

\subsection{Hierarchical levels of control objectives}
There are different conceptual levels of control for the wind turbines, each of them with a specific target, as could be seen in \autoref{fig:control_levels} (source \cite{9535421}).
\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.7\columnwidth]{images/control_levels.jpg}
  \caption{General control structure of a wind power systems,  source \cite{9535421}}
  \label{fig:control_levels}
\end{figure}

On the higher hierarchical level ($\textit{advanced feature}$ in \autoref{fig:control_levels}) there are the handling of start up and shut down operations, alongside the extreme events, and possibly the integration with others turbines in the neighborhood. The primary objective of the $\textit{wind system specific control}$ is to keep the rotor speed and generated power within limits. Secondary objectives include the reduction of the load on the mechanical components (both as peak values and fatigue) and the reduction of the vibrations. In modern offshore turbines this has also to take into account the external load applied by the waves. At the $\textit{basic control}$ level there are some functions that are not strictly related to the wind turbine field, but are common to all the electric drives connected to the grid. Finally, at the lower hierarchical level there are the commands for the switching devices at the generator and grid side. 

\subsection{Operational regions of a WT}
Even thought the scope of a \acrshort{WT} is usually to harvest as much mechanical energy as possible by reducing the wind's kinetic one, different working regions and corresponding wind speeds levels may be identified depending on the followed literature. For example \cite{Olimpo_Anaya‚ÄêLara} uses two regions (called I and II), \cite{5874598} uses three (called 1, 2, 3), while \cite{10-MW_Direct-Drive_PMSG-Based_Wind_Energy_Conversion_System_Model} uses five (called I, II, III, IV, and V). A common denominator is that in all of the sources the \textit{partial load} and the \textit{full load} regions are identified. The \textit{partial load} is bounded between the \textit{cut-in wind speed} (i.e. the minimum wind speed required to enable the blade rotation) and the \textit{rated wind speed} (i.e. the lowest velocity at which the rated mechanical power is produced), and the mechanical power is below the rated one. Complementary, in the \textit{full load} the mechanical power would exceed the rated one, but it is limited by the controller. The boundaries of this regime are the rated wind speed and the \textit{cut-out} one (i.e. the maximum one taken into account during the design phase). \\
The further identified region in \cite{5874598} and region I in \cite{10-MW_Direct-Drive_PMSG-Based_Wind_Energy_Conversion_System_Model} is the one below cut-in, when the rotor is kept still by the brakes. Region III in \cite{10-MW_Direct-Drive_PMSG-Based_Wind_Energy_Conversion_System_Model} is the switching between the partial and full load, while IV is the region above cut-out when the rotor is kept locked by the brakes. Even though the division in 5 zones is more complete, the one with 2 is sufficient for identifying the conceptual differences. 
\begin{figure}[htb]
    \centering
    \includegraphics[width=0.5\textwidth]{images/operating_reagions.png}
    \caption{Wind speed division in 5 different operating regions according to \cite{10-MW_Direct-Drive_PMSG-Based_Wind_Energy_Conversion_System_Model}, \textcolor{red}{Se ho tempo cerco di rifare in matlab questa immagine in modo che venga meglio }}
    \label{fig:operating_reagions}
\end{figure}

\subsection{Power control}
As could be seen in \autoref{eq:power}, the mechanical power scales with the cubic of the wind speed, meaning that operating at the maximum power coefficient ($c_{P, max}$) may quickly lead to exceeding the maximum load for which the blades are designed and the power manageable by the different subsystems. In order to limit these loads, control actions have to be taken. The most common approaches go under the families of stall regulation and the variable-speed pitch regulation, as reported in \cite{Aerodynamics_of_wind_turbines}.

\subsubsection{Power control based on stall regulation}\label{subsec:stall_regulation_theory}
The \acrshort{WTs} employing this method are the simplest ones from the mechanical point of view and in fact it was used in the first generators. Nowadays it is no more chosen in the MW-size turbines, even though \cite{Grasso_2016} reports that it may be still used in some small and medium kW turbines because their construction require a reduced number of components and sensors and hence reduce design complexity and costs. This simplicity is due to the fact that the blades are bolted to the hub and cannot be pitched once they are setted. Furthermore the electrical generator often employed is the robust asynchronous machine, requiring an almost constant rotational speed.

From the aerodynamic point of view, when the incoming wind increases its speed, then the \acrshort{AOA} decreases reducing the lift \textit{l} and increasing the drag \textit{d}, leading to a lower tangential load, which is given by:
\begin{equation}
  p_T = l \sin(\phi) - d \cos(\phi) \mesunt{\newton} \text{ with } \alpha = \phi - \theta
  \label{eq:tangential_load}
\end{equation}
\acrshort{pT} is the force tangential to the rotorplane, $\alpha$ is the \acrshort{AOA}, \acrshort{phi} is the \textit{flow angle} between the plane of rotation and the relative velocity, \acrshort{lift} is the lift force on the blade, and \acrshort{d} is the drag force on the blade.

The fixed pitch construction has the drawback of being rigid since the maximum power reduction is limited by the initial positioning of the blades, and their re-setting is possible only by unbolting and repositioning them. Hence, whenever the generator stops to produce a resisting torque, it is possible that the stalling would not be effective enough to avoid the acceleration of the drivetrain, increasing the risks of breakage for the components. In that case aerodynamic safety systems are activated, for example by turning the outer part of the blades of 90$\si{\degree}$ with respect to the rotor plane. 

\subsubsection{Power control based on pitch regulation with constant rotor rotational speed}
This control mechanism is in some way an extension of the previous one, since the pitch angle can be actively controlled along the blade while the rotor rotation speed is kept constant. This method allows the use of an asynchronous machine while limits the power when the incoming tends to grow too much. \\
 The pitching mechanism may be implemented with different kinds of mechanical systems, such as hydraulic pistons, hydraulic motors, or electrical motors. \\
Since the dynamic of the wind fluctuations are faster than the ones of the blade pitching system, then it is possible that the pitch regulated WT behaves like a stall regulated \acrshort{WT} for some time and so the output power locally exceeds the rated one.\\
Neither this kind of machines are nowadays employed.

\subsubsection{Power control based on pitch regulation with variable rotor rotational speed}
This is the most common type nowadays, and the \acrshort{WTs} investigated in this work belongs to this kind. Their working philosophy in partial load regime is to vary the rotor speed in order to keep $\lambda = \lambda_{MAX}$ in \autoref{eq:TSR}, and consequently $c_p=c_{p,max}$. On the other hand, in the full load region the rotational speed is kept constant at $\omega = \omega_{rated}$ while the power is limited by acting on the pitch angle, and so on the $c_P$ in the relation $c_P(\lambda, \theta)$. The switching between the regions may be done using some smoothing functions. \\
Since the rotational speed of the rotor is not fixed anymore, as it was in the stall regulated machine, here the electrical generator should be able to operate in a wide range of velocities. Such kind of machines cannot be directly connected to the electrical grid, because the produced voltage has a frequency proportional to the operating speed, which is not constant. The problem may be solved by employing an electrical conditioning interface firstly rectifying the voltage, and then converting the DC to AC with desired frequency. \\
In addition to the classification done in \ref{subsec:mech_pow_and_pow_coeff} (i.e. feather/stall) another one can be done based on the number of blades simultaneously controlled. In fact, both feathering and stalling can be implemented either as \textit{collective} or \textit{individual} strategy. In the first one the same pitching angle is applied to all the blades, while in the second a specific angle is set to each blade according its azimuthal position (which has to be known from measurements).

\subsection{Yaw control}
The yaw controller rotates the nacelle in order to set the orientation of the rotor-plane w.r.t. the incoming wind speed. In stall and pitch controlled \acrshort{WTs} this is done in order to align the rotational axis with the incoming stream and so maximizing the air passing through the rotor. \\
According to \cite{Aerodynamics_of_wind_turbines}, some attempts to develop a power controller based only on the yaw have been done in the past, but with low implications nowadays at turbine level. 

\subsection{Electrical generator control}
As exposed in \autoref{subsec:electrical_generator_description}, different types of generators may be employed in the WTs, each of them requiring a different control method at the \textit{basic control} level of the \autoref{fig:control_levels}. \\
For the sake of the thesis, a power control has to be implemented, meaning that the \textit{Wind System Specific Control} (according to the notation of \autoref{fig:control_levels}) generates a reference power level that is compared with the actual produced power. Then their difference is converted firstly in a torque and finally in a current reference used to control the generator at the \textit{basic control} level. Alongside this current loop, an inner voltage one regulating the speed is present too. This particular choice is done because the synthesis of the power/torque reference signal in the two control regions is relatively easy. Further details on the design on the modelling of the chosen PMSM machine and its regulators will be given in \autoref{subsec:electrical_generator_description} and \autoref{subsec:generator_low_level-control}.