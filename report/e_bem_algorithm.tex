\begin{algorithm}
\caption{Algorithm for the application of the BEM on the entire blade}\label{alg:MainBEM}
\begin{algorithmic}
\State load airfoil data
\State load blade parameters
\State initialize a vector of lambda
\State initialize a vector of $\Theta_p$

% Main code
\For{ $\lambda \in \left[\lambda_{MIN}, \lambda_{MAX}\right]$ }
  \For{ $\Theta_p \in \left[\Theta_{p,MIN}, \Theta_{p,MAX}\right] $ }
    \For{ $r \in \left[0, r_{MAX}\right]$ }
    \State run BEM code
    \EndFor 
    \State integrate the partial results of different r
    \State store $\lambda$, $\Theta_p$, cP, cT
 \EndFor
\EndFor 
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{BEM code pseudo algorithm}\label{alg:BEM}
\begin{algorithmic}
% BEM code
\State INPUT: $r, \Theta_p, \lambda$
\State OUTPUT: $a, a'$
\State CONSTANT: $\beta, c, B$
\State initialize a, a'

\For {$i < i_{MAX}$}
  \State $a_{OLD}=a; \ a'_{OLD}=a'$
  \State  $\phi=atan\left(\frac{(1-a)R}{(1+a')\lambda r}\right)$ 
  \State  $\Theta=\beta + \Theta_p$
  \State  $\alpha = \phi - \Theta$
  \State interpolate $c_l$ and $c_d$ from the table
  \State  $c_n = c_l cos(\phi) + c_d sin(\phi)$
  \State  $c_t = c_l sin(\phi) - c_d cos(\phi)$
  \State  $F = \frac{2}{\pi} acos \left[\exp\left(\frac{-B(R - r)}{2r\sin(\left|\phi\right|)}\right)\right]$
  \State $\sigma = \frac{cB}{2\pi r}$
  \If {$a < \frac{1}{3}$}
  \State a = $\frac{\sigma c_n (1 - a)}{4 F \sin(\phi)^2}$
  \Else
    \State $c_T = \frac{(1 - a)^2c_n\sigma}{\sin(\phi)^2}$
    \State $\beta_c = 0.1$
    \State $a_s = \frac{c_T}{4F(1 - 1/4(5 - 3a)a)}$
    \State $a = \beta_c a_s + (1 - \beta_c)a$
  \EndIf
  \State $a' = \frac{\sigma*c_T*(1 + a')}{4F\sin(\phi)\cos(\phi)}$
  \If {$\left|a - a_{OLD}\right| < \varepsilon \ \& \ \left|a' - a'_{OLD}\right| < \varepsilon$} % epsilon = 1e-8
    \State break
  \Else
    \State go on
  \EndIf
\EndFor
\end{algorithmic}
\end{algorithm}