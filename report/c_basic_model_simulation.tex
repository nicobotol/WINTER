\newpage
\section{Simulation for standard control techniques}\label{sec:c_basic_model_simulation}
In this section the developed model is tested under different conditions as slowly increasing wind ramp, random wind series, random wind series and disabling of the pitch controller, random wind series and different pitching dynamics, comparison between torque gain based on the rotor and generator power for constant wind speed.
\subsection{Simulation with velocity ramp}
\subsubsection{Simulation setting}
The model is tested providing as wind input a ramp starting at time 0 $\left[\si{\second}\right]$. Other four parameters may be changed in the simulation: starting and finishing wind speeds, time length of the ramp, and the initial rotor velocity.\\
It is decided to test 3 wind velocity conditions to investigate the three main operating region. \autoref{tab:simulation_config} reports the configurations of these simulations. 
\begin{table}[htb]
    \caption{Configuration parameters for the simulation}
    \centering
    \begin{tabular}{lcccc}
    \toprule
      Simulation & Regime  & WS & Ramp length \\ 
       & & $\left[\si{\meter\per\second}\right]$ & $\left[\si{\second}\right]$ \\ \midrule       
       I & Below & 4-10 & 200  \\
       II & Below $\rightarrow$ above rated & 10-14 & 200 \\
       III & Above & 14-20 & 200  \\
       \bottomrule
    \end{tabular}
    \label{tab:simulation_config}
\end{table}

An interesting post-process check can be done on the powers, in particular that the one provided by the wind is equal to the sum between the one processed by the generator, the one stored in the inertia and the one lost in the damping. In particular the power equations to the rotor side of the transmission can be written starting from \autoref{eq:mech_eq}:
\begin{gather}
    J_{eq}\dot{\omega^{R}} = T_R^R - T_G^R-B_{eq}\omega_R\\
    J_{eq}\dot{\omega^{R}} + T_G^R + B_{eq}\omega^R = T_R^R\\
    \left(J_{eq}\dot{\omega^{R}} + T_G^R + B_{eq}\omega^R\right)\omega^R = \left(T_R^R\right)\omega^R\\
    J_{eq}\dot{\omega^{R}}\omega^{R} + T_G^{R}\omega^{R} + B_{eq}\omega^{R^{2}} = T_R^{R}\omega^{R}\\
    P_{inertia} + P_{generator} + P_{damping} = P_{rotor} 
    \label{eq:power_balance}
\end{gather}

\subsubsection{Simulation results}
The results of the simulations are reported in \autoref{fig:simulation_1}, \ref{fig:simulation_2}, \ref{fig:simulation_3}. \\
In particular, the figure a) reports the wind velocity as function of the simulation time. b), c), and d) are the parametrizations of the rotor rotational speed, the power, and the pitch angle as function of the wind speed. e) is the power check, as described in \autoref{eq:power_balance}. Finally, f) is the torque that the controller imposes at the generator as function of the rotor rotational speed. 
% plots of the results
\input{c_basic_model_results}

It could be seen that below rated wind speed there is a deviation between the rotor speed computed with the equations and the one obtained in the simulation. The mainly two possible sources of this difference are that the rate of change of the wind speed is higher then the time required to the rotor to reach the steady state conditions, \textcolor{blue}{and the possible steady state error in the generator controller as discussed before}. 

\subsection{Simulation with generated wind time series}\label{sec:wind_series_sim}
\subsubsection{Simulation settings}
The model is tested with an input wind time series three times, the first with mean \acrshort{WS} of 6 $\mesunt{\meter\per\second}$, the second with  11 $\mesunt{\meter\per\second}$, and the third with 20 $\mesunt{\meter\per\second}$. These values are chosen to test the simulator in the three characteristics wind regimes. In the first simulation the turbulence is chosen to be $\sigma=0.6 \mesunt{\meter\per\second}$ while for the other $\sigma=1 \mesunt{\meter\per\second}$. The simulation is run for $t=150\ \mesunt{\second}$ and the results of the last 100 $\mesunt{\second}$ are plotted in order to get rid of the transient behavior. The sampling frequency for the wind series generation is set to be $f_s=50 \left[\si{\hertz}\right]$.

\subsubsection{Simulation results}
The results of this simulation are reported in \autoref{fig:simulation_rand_wind_NPC}, where the wind time series and the parametrizations of some quantities as function of the instantaneous wind speed are reported on top of the corresponding reference lines obtained by static analysis. \\
What can be seen from the results is that the observed quantities are clustered around the static curve. This is something reasonable since if the turbulence would have been set to 0 then the expected results would have been a point on the static curve corresponding to the investigated WS. It must be highlighted that in these curves the initial transient part has been eliminated in order to have a better visualization. 

\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_52_01fig_wind_TS.eps}
    \caption{Wind time series}
    \label{fig:2023_05_1_00_55_48fig_wind_TS.eps}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_39_46fig_pitch_param.eps}
    \caption{Pitch angle time series}
    \label{fig:2023_05_1_00_50_19fig_power_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_37_59fig_power_param.eps}
    \caption{Input power to the generator}
    \label{fig:2023_05_1_00_51_17fig_omega_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_40_32fig_omega_param.eps}
    \caption{Rotational speed}
    \label{fig:2023_05_1_00_50_58fig_pitch_param}
  \end{subfigure}
  \caption{Results of simulation with a generated wind series}
  \label{fig:simulation_rand_wind_NPC}
\end{figure}

\subsection{Disabling of the pitch angle gain scheduling}\label{subsec:gain_scheduling_disabling}
In order to verify the effect of the gain scheduling with respect a fixed gain for the pitch angle controller, three simulations with different wind speeds are proposed, $V_{10} = 11.5, 15, 20 \ \mesunt{\meter\per\second}$. For each of them four different gains are used. The settings for all of them are reported in \autoref{tab:simulation_config_variable_gains}, \autoref{tab:simulation_config_variable_gains2}, and \autoref{tab:simulation_config_variable_gains3}. \\
In particular, the first and the fourth simulations use the gain scheduling paradigm while the other two have a fixed gain. The specific numerical value chosen in the constant case are representative of two very different regions of the scheduling case since \textit{simulation 2} has values close to the ones used at low wind speeds, while \textit{3} has value close to the high wind speeds. 

\subsubsection{Wind speed of  $V_{10} = 11.5 \ \mesunt{\meter\per\second}$}
The first of the three simulations is run at $V_{10} = 11.5 \ \mesunt{\meter\per\second}$. Here an intermitting activation of the pitching mechanism is expected since the wind speed fluctuates around its nominal value.\\
\autoref{tab:simulation_config_variable_gains} reports the simulation settings while \autoref{fig:gain_scheduling_time_dependency} reports the time evolution of the pitch angle, rotor rotational speed, and the generator torque obtained from the simulations. 

\begin{table}[htb]
  \caption{Configuration parameters for the simulation in \autoref{fig:gain_scheduling_time_dependency}}
  \centering
  \begin{tabular}{ccccc}
  \toprule
    Simulation & $V_{10}$  & $\sigma_{V_{10}}$ & Gains schedule \\ 
     & $\left[\si{\meter\per\second}\right]$ & $\left[\si{\meter\per\second}\right]$ & \\ \midrule       
     1 & 11.5 & 1 & As in \autoref{subsec:gain_schdeuling_DTU10MW}  \\
     2 & 11.5 & 1 & $k_p = 2 \ \mesunt{\second}$, $k_i=0.9 \ [-]$ \\
     3 & 11.5 & 1 & $k_p = 0.25 \ \mesunt{\second}$, $k_i=0.2 \ [-]$  \\
     4 & 11.5 & 1 & As reported in \cite{Olimpo_Anaya‐Lara}  \\
     \bottomrule
  \end{tabular}
  \label{tab:simulation_config_variable_gains}
\end{table}

\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_47_54fig_wind_TS.eps}
    \label{fig:fig_wind_15ms}
    \caption{Wind time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_48_02fig_pitch_dynamic.eps}
    \label{}
    \caption{Pitch angle time series}
  \end{subfigure}
  \vskip\baselineskip
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_48_13fig_omega_dynamic.eps}
    \label{}
    \caption{Rotor rotational speed time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_48_43fig_torque_dynamic.eps}
    \label{}
    \caption{Torque time series}
  \end{subfigure}
  \vskip\baselineskip
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_48_24fig_power_dynamic.eps}
    \label{}
    \caption{Power time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_49_17fig_generator_power_check.eps}
    \label{}
    \caption{Generator power time series}
  \end{subfigure}
  \caption{Comparison of the simulation with generated time series and three different gain scheduling strategies}
  \label{fig:gain_scheduling_time_dependency}
\end{figure}
After the simulation and in order to evaluate it quantitatively, the RMS error between the steady state quantities (i.e. the last 40 seconds of the simulation) and the corresponding expected nominal values above rated wind speed are computed, and reported in \autoref{tab:res_variable_gains}.\\

In this simulation these error metrics are not so representative since the wind is not always above the rated one and therefore the corresponding power, torque and rotational speed are not always expected to be reached. They are reported anyway in order to be then compared with the simulations proposed later on.  

\begin{table}[htb]
  \caption{Quantitative evaluations of the results obtained with setting in \autoref{fig:gain_scheduling_time_dependency}}
  \centering
  \begin{tabular}{ccccc}
  \toprule
    Simulation & $\omega_R$  & $P_G$ & $T_G$ \\ 
     & $\left[\si{\radian\per\second}\right]$ & $\left[\si{\mega\watt}\right]$ &$\left[\si{\mega\newton\meter}\right]$ \\ \midrule       
     1 & 0.031 & 0.833 & 0.563 \\
     2 & 0.030 & 0.832 & 0.557 \\
     3 & 0.047 & 1.128 & 0.802 \\
     4 & 0.036 & 0.902 & 0.629 \\
     \bottomrule
  \end{tabular}
  \label{tab:res_variable_gains}
\end{table}
The first two simulations are very close each other, since the static gain of \textit{sim. 2} is almost the same of the scheduling at rated speed. Furthermore, the results of the fourth simulation are not too different from the first two. Finally, it could be also noticed that the gain in case \textit{3} is very different from the other one, suggesting that this choice is not suitable for this condition. 

\subsubsection{Wind speed of $V_{10}=15 \ \mesunt{\meter\per\second}$}
The second simulation is run with $V_{10}=15 \ \mesunt{\meter\per\second}$, and so the wind speed is expected to be always above the rated one. The simulation settings are reported in \autoref{tab:simulation_config_variable_gains2}.
\begin{table}[htb]
  \caption{Configuration parameters for the simulation in \autoref{fig:gain_scheduling_time_dependency2}}
  \centering
  \begin{tabular}{ccccc}
  \toprule
    Simulation & $V_{10}$  & $\sigma_{V_{10}}$ & Gains schedule \\ 
     & $\left[\si{\meter\per\second}\right]$ & $\left[\si{\meter\per\second}\right]$ & \\ \midrule       
     1 & 15 & 1 & As in \autoref{subsec:gain_schdeuling_DTU10MW}  \\
     2 & 15 & 1 & $k_p = 2 \ \mesunt{\second}$, $k_i=0.9 \ [-]$ \\
     3 & 15 & 1 & $k_p = 0.25 \ \mesunt{\second}$, $k_i=0.2 \ [-]$  \\
     4 & 15 & 1 & As reported in \cite{Olimpo_Anaya‐Lara}  \\
     \bottomrule
  \end{tabular}
  \label{tab:simulation_config_variable_gains2}
\end{table}

\autoref{fig:gain_scheduling_time_dependency2} reports the time evolution of the pitch angle, rotor rotational speed, and the generator torque. 

\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_14_10_06fig_wind_TS.eps}
    \label{fig:2023_05_9_20_55_30fig_wind_TS}
    \caption{Wind time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_14_10_11fig_pitch_dynamic.eps}
    \label{fig:2023_05_9_20_55_30fig_pitch_dynamic}
    \caption{Pitch angle time series}
  \end{subfigure}
  \vskip\baselineskip
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_14_10_21fig_omega_dynamic.eps}
    \label{fig:2023_05_9_20_55_46fig_omega_dynamic}
    \caption{Pitch angle time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_14_10_52fig_torque_dynamic.eps}
    \label{fig:2023_05_9_20_56_15fig_torque_dynamic}
    \caption{Torque time series}
  \end{subfigure}
  \vskip\baselineskip
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_14_10_32fig_power_dynamic.eps}
    \label{fig:2023_05_9_20_55_59fig_power_dynamic}
    \caption{Power time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_15_07_04fig_generator_power_check.eps}
    \label{fig:2023_05_20_15_07_04fig_generator_power_check}
    \caption{Generator power time series}
  \end{subfigure}
  \caption{Comparison of the simulation with generated time series and three different gain scheduling strategies}
  \label{fig:gain_scheduling_time_dependency2}
\end{figure}

The \acrshort{RMS} error between the steady state value and the corresponding expected static is evaluated. The results are reported in the \autoref{tab:res_variable_gains2}.
\begin{table}[htb]
  \caption{Quantitative evaluations of the results obtained with setting in \autoref{fig:gain_scheduling_time_dependency2}}
  \centering
  \begin{tabular}{ccccc}
  \toprule
    Simulation & $\omega_R$  & $P_G$ & $T_G$ \\ 
     & $\left[\si{\radian\per\second}\right]$ & $\left[\si{\mega\watt}\right]$ &$\left[\si{\mega\newton\meter}\right]$ \\ \midrule       
     1 & 0.011 & 0.262 & 0.190 \\
     2 & 0.009 & 0.171 & 0.138 \\
     3 & 0.020 & 0.486 & 0.349 \\
     4 & 0.016 & 0.406 & 0.288 \\
     \bottomrule
  \end{tabular}
  \label{tab:res_variable_gains2}
\end{table}

As could be seen from the root mean square errors, the gain scheduling simulations performs better than the fixed one. In fact, even tough \textit{simulation 2} has lowest error value, the ones of \textit{4} are almost double than the \textit{1}. This means that a fixed gain may perform well in a certain wind region (i.e. the one corresponding at the same gain in the scheduling approach) but probably it will underperform in another different from that one.  

\subsubsection{Wind speed with $V_{10} =  20 \ \mesunt{\meter\per\second}$}
The last tested \acrshort{WS} is 20 $\mesunt{\meter\per\second}$. The simulation parameters are reported in \autoref{tab:simulation_config_variable_gains3} while the results in \autoref{fig:gain_scheduling_time_dependency3} and \autoref{tab:res_variable_gains3}.

\begin{table}[htb]
  \caption{Configuration parameters for the simulation in \autoref{fig:gain_scheduling_time_dependency3}}
  \centering
  \begin{tabular}{ccccc}
  \toprule
    Simulation & $V_{10}$  & $\sigma_{V_{10}}$ & Gains schedule \\ 
     & $\left[\si{\meter\per\second}\right]$ & $\left[\si{\meter\per\second}\right]$ & \\ \midrule       
     1 & 20 & 2.0 & As in \autoref{subsec:gain_schdeuling_DTU10MW}  \\
     2 & 20 & 2.0 & $k_p = 2 \ \mesunt{\second}$, $k_i=0.9 \ [-]$ \\
     3 & 20 & 2.0 & $k_p = 0.25 \ \mesunt{\second}$, $k_i=0.2 \ [-]$  \\
     4 & 20 & 2.0 & As reported in \cite{Olimpo_Anaya‐Lara}  \\
     \bottomrule
  \end{tabular}
  \label{tab:simulation_config_variable_gains3}
\end{table}

\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_16_31_57fig_wind_TS.eps}
    \label{}
    \caption{Wind time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_16_32_05fig_pitch_dynamic.eps}
    \label{}
    \caption{Pitch angle time series}
  \end{subfigure}
  \vskip\baselineskip
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_16_32_15fig_omega_dynamic.eps}
    \label{}
    \caption{Pitch angle time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_16_32_45fig_torque_dynamic.eps}
    \label{}
    \caption{Torque time series}
  \end{subfigure}
  \vskip\baselineskip
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_16_32_26fig_power_dynamic.eps}
    \label{}
    \caption{Power time series}
  \end{subfigure}
  \hfill
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_16_33_21fig_generator_power_check.eps}
    \label{}
    \caption{Generator power time series}
  \end{subfigure}
  \caption{Comparison of the simulation with generated time series and three different gain scheduling strategies}
  \label{fig:gain_scheduling_time_dependency3}
\end{figure}

\begin{table}[htb]
  \caption{Quantitative evaluations of the results obtained with setting in \autoref{fig:gain_scheduling_time_dependency3}}
  \centering
  \begin{tabular}{ccccc}
  \toprule
    Simulation & $\omega_R$  & $P_G$ & $T_G$ \\ 
     & $\left[\si{\radian\per\second}\right]$ & $\left[\si{\mega\watt}\right]$ &$\left[\si{\mega\newton\meter}\right]$ \\ \midrule       
     1 & 0.023 & 0.483 & 0.359 \\
     2 & 0.018 & 0.319 & 0.257 \\
     3 & 0.033 & 0.769 & 0.556 \\
     4 & 0.031 & 0.742 & 0.533 \\
     \bottomrule
  \end{tabular}
  \label{tab:res_variable_gains3}
\end{table}

\subsubsection{Gain disabled and parametrization plot}

Another comparison between the use or not of the gain scheduling may be done repeating the simulations done in \autoref{sec:wind_series_sim} but disabling the blade gain scheduling, and letting the gains of the previous \textit{simulation 2} (i.e. $k_p = 2 \ \mesunt{\second}$, $k_i=0.9 \ [-]$). The corresponding results are reported in \autoref{fig:simulation_rand_wind_no_gain_scheduling}.
\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_19fig_wind_TS.eps}
    \caption{Wind time series}
    \label{fig:2023_05_8_22_43_35fig_wind_TS.eps}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_46fig_pitch_param.eps}
    \caption{Pitch angle time series}
    \label{fig:2023_05_8_22_44_05fig_pitch_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_24fig_power_param.eps}
    \caption{Input power to the generator}
    \label{fig:2023_05_8_22_44_15fig_power_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_57fig_omega_param.eps}
    \caption{Rotational speed}
    \label{fig:2023_05_8_23_17_57fig_omega_param}
  \end{subfigure}
  \caption{Results of simulation with a generated wind series, no blade gain scheduling}
  \label{fig:simulation_rand_wind_no_gain_scheduling}
\end{figure}

\subsubsection{Conclusions}
The results obtained in \autoref{subsec:gain_scheduling_disabling} shows that the choice of the gain highly influences the performance of the system. In particular the gain used in the \text{sim. 3} seems to be always the worst choice in the tested cases. Between the scheduling rule, the one proposed in \autoref{subsec:gain_schdeuling_DTU10MW} seems to perform better than the one of \cite{Olimpo_Anaya‐Lara}. Finally, it seems that the constant gain used in \textit{sim. 2} is always the best choice, probably because it is the highest one and so produces the response with the highest effort. \textcolor{red}{Maybe a better explanation can be found.}

\subsection{Disabling of the pitch angle controller}
In order to show the effectiveness of the blade pitch controller one can disable it at all and let the turbine working at fixed pitch angle as happened for the purely stall regulate one (see \autoref{subsec:stall_regulation_theory}). What it is different between the concept presented before and this simulation is the control objective of the electrical machine, since in the stall regulated was the rotational speed while now it is the generator incoming power. \\
In the simulations, the disabling is performed setting $k_p=0 \ \mesunt{\second}$ and $k_i=0 \ [-]$. \textcolor{red}{WRITE IT BETTER, SUMMARIZING WHAT IT IS WRITTEN IN THE THEORETICAL PART - It is expected that increasing the wind speed above the rated one, the rotor rotational speeds increase (and consequently the extracted power), up to the drag becomes so high to let the rotor speed to decrease on its own. }\\
This test case is run with the same input velocity used in \autoref{fig:gain_scheduling_time_dependency2}, and some of the results of the simulations are reported in \autoref{fig:simulation_rand_wind_no_pitch_control}, alongside the case of blade pitch scheduling for better understanding the differences. In particular the \textit{sim. 1} uses the scheduling of \autoref{subsec:gain_schdeuling_DTU10MW} while the \textit{sim. 2} is the one with disabled gain.\\
More in detail, \autoref{fig:pitch_dynamic_no_ctrl} shows that in \textit{sim. 2} the pitch is not changed, while the other does so. \autoref{fig:omega_dynamic_no_ctrl} shows that the rotational speed is limited at the rated value in \textit{sim. 1}, while it is almost doubled in\textit{sim. 2}. It must be noted that in a purely stall regulated machine the rotational speed would have been controlled to a constant value in order to produce the voltage at the desired frequency.\\
\autoref{fig:power_dynamic_no_ctrl} shows that the power extracted from the wind is much higher in the second simulation than in the first one while the mechanical power at the generator is the same. This is explained by the fact that the controller acts reducing the torque at almost half of the previous one (see \autoref{fig:torque_dynamic_no_ctrl}).

\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_22_30_17fig_pitch_dynamic.eps}
    \caption{Pitch angle time series}
    \label{fig:pitch_dynamic_no_ctrl}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_22_30_24fig_omega_dynamic.eps}
    \caption{Rotor rotational speed time series}
    \label{fig:omega_dynamic_no_ctrl}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_22_45_11fig_power_dynamic.eps}
    \caption{Rotor power and generator input power}
    \label{fig:power_dynamic_no_ctrl}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_20_22_30_44fig_torque_dynamic.eps}
    \caption{Rotational speed}
    \label{fig:torque_dynamic_no_ctrl}
  \end{subfigure}
  \caption{Results of simulation with a generated wind series, no blade control}
  \label{fig:simulation_rand_wind_no_pitch_control}
\end{figure}

\subsection{Changing of the pitching actuator dynamic}\label{subsec:changing_pitch_actuator}  
In this section the dynamic of the pitching mechanism is changed in order to see the different reactivity in the reduction of the power extracted form the wind. It is expected that making the dynamic faster allow to follow the wind fluctuations better at the price of a higher effort, while a slower dynamic will produce a less effective control. \\
It is expected that in this latter case, a rapid grow of the WS may drive the mechanism to increase the pitch angle but if then the resource slows down then the power drops far from the rated one.\\
For validate this hypothesis, three simulations are run with different transfer functions modelling the blade actuator. All of them are run with the usual wind speed of $V_{10}=15\ \mesunt{\meter\per\second}$ and $\sigma_{V_{10}}=1 \ \mesunt{\meter\per\second}$. \\
The employed transfer functions are reported in \autoref{tab:tf_blade_mechanism}:
\begin{table}[htb]
  \caption{Transfer functions modelling the blade actuator}
  \centering
  \begin{tabular}{cc}
  \toprule
    Simulation & G=$\frac{\theta}{\hat{\theta} }$\\\midrule
    1 & $\frac{(2\pi)^2}{s^2+2 \, 0.7 \, 2\pi+(2\pi)^2}$\\
    2 & $\frac{1}{1}$\\
    3 & $\frac{(\frac{2\pi}{5})^2}{s^2+2\, 0.7 \,\frac{2\pi}{5}+(\frac{2\pi}{5})^2}$\\
    \bottomrule
  \end{tabular}
  \label{tab:tf_blade_mechanism}
\end{table}

It must be noted that Simulation 1 is what suggested in \cite{Olimpo_Anaya‐Lara}, while 2 corresponds to no no delay.

\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_07_10_17_17_35fig_wind_TS.eps}
    \caption{Wind speed time series}
    \label{}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_07_10_17_17_56fig_pitch_dynamic.eps}
    \caption{Dynamic of the pitch angle}
    \label{}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_07_10_17_18_12fig_omega_dynamic.eps}
    \caption{Rotational speed}
    \label{}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_07_10_17_18_22fig_power_dynamic.eps}
    \caption{Power extracted from wind and mech. power at the generator}
    \label{}
  \end{subfigure}
  \caption{Results of simulation with a generated wind series, different blade actuation mechanisms}
  \label{fig:simulation_with_different_pitch_dynamic}
\end{figure}
The results of the simulations are reported in \autoref{fig:simulation_with_different_pitch_dynamic} and they show how the first two mechanisms are pretty similar, meaning that the transfer function suggested by \cite{Olimpo_Anaya‐Lara} and employed in all the other simulation so far does not introduce a grate delay in the response of the blade actuation. On the other hand, the third transfer function is slower, meaning that the blades follow the wind change with some delay and for this reason they are rotate of larger amount.

\subsection{Simulation with the controller based on generator output} \label{subsec:validation_control_P_GE}
% For this simulation, in order to avoid the interference of the controller not allowing the generator to reach the steady state, this component has been removed and the torque reference value has been directly used into the dynamic equation of the rotor power.
\subsubsection{Below rated wind speed}
The two control laws have been compared for WS between the cut in and the rated one, assuming that no damping (i.e. $B=0 \mesunt{\kilo\gram\square\meter\per\second}$).\\
A critical condition for this test is that the rotor rotational speeds is exactly the one prescribed by the desired tip speed ratio. In order to avoid possible influences of a poor tuned generator controller, the generator has been excluded from the simulation and the torque reference has been directly used in the dynamic equation. Furthermore, the neglecting of the damping removes the corresponding loss power in the balance. \\
In the simulation, 5 constant wind speeds has been provided and the corresponding steady state values of mechanical input and electrical output powers to the generator have been evaluated. The results are reported in \autoref{fig:comparison_control_laws}.
\begin{figure}[htb]
  \centering
  \includegraphics[width = \columnwidth]{images/vectorial/2023_07_10_10_21_02comparison_control_laws.eps}
  \caption{Comparison of input and output power to the generator for the control laws based on the maximization of the power extracted from the resource (called \textit{rotor} in the legend) and the maximization of the power generated electrical power (called \textit{generator} in the legend).}
  \label{fig:comparison_control_laws}
\end{figure}

Even tough the differences are small, it could be seen that the control law based on the maximization of the power at the rotor side (called \textit{rotor} in the legend) is able to provide more mechanical input power, while the one based on the generator electrical output power (called \textit{generator} in the legend) is able to provide more electrical power.
\subsubsection{Transition below-above rated WS}
The test has been done in steady state conditions, with a velocity ramp between 8 and 15 $\mesunt{\meter\per\second}$ lasting 150 seconds. In that case the damping and the generator are both taken into account.\\
The results are reported in \autoref{fig:fig_blade_control_gen_side_validation}. \autoref{fig:2023_06_22_21_03_26fig_pitch_param} shows how the actual pitch angle follows what is predicted from the static map of \autoref{fig:fig_new_pitch_map}. As expected, since the blade are rotated less then what was required in the generator case, the mechanical power extracted from the resource is slightly higher. This is also visible in \autoref{fig:2023_06_22_21_02_45fig_generator_power_check}, where it is also highlighted that the generator's produced electrical power is kept constant at the rated value above the rated WS. Finally, \autoref{fig:2023_06_22_21_02_45fig_generator_power_check} shows how does the presence of the inertia made the power available at the input of the generator lower than the rotor one, and so in principle the controller could be less responsive due to a small lag in reaching the rated value. 
\begin{figure}[htb]
  \begin{subfigure}{0.5\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/vectorial/2023_06_24_21_42_22fig_pitch_param.eps}
    \caption{Pitch angle}
    \label{fig:2023_06_22_21_03_26fig_pitch_param}
  \end{subfigure}
  \begin{subfigure}{0.5\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/vectorial/2023_06_24_21_41_37fig_power_param.eps}
    \caption{Mechanical power at the rotor side}
    \label{fig:2023_06_22_21_03_05fig_power_param}
  \end{subfigure}
  \begin{subfigure}{0.5\textwidth}
    \centering
    \includegraphics[width=\textwidth]{images/vectorial/2023_06_24_21_41_05fig_generator_power_check.eps}
    \caption{Incoming and outgoing power at the generator side}
    \label{fig:2023_06_22_21_02_45fig_generator_power_check}
  \end{subfigure}
  \caption{Results of the validation of the control based on the power output at the generator side}
  \label{fig:fig_blade_control_gen_side_validation}
\end{figure}
\newpage