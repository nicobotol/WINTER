\newpage
\section{Basic model simulation}\label{sec:c_basic_model_simulation}

\subsection{Simulation with velocity ramp}
\subsubsection{Simulation setting}
The model is tested providing as wind input a ramp starting at time 0 $\left[\si{\second}\right]$. Other four parameters may be changed in the simulation: starting and finishing wind speeds, time length of the ramp, and the initial rotor velocity.\\
It is decided to test 4 wind velocity conditions, and for each of them simulate 3 rising time, as stated in \autoref{tab:simulation_config}. For each of them, the initial rotational speed is set to be compatible with the initial \acrshort{WS}:

\begin{table}[htb]
    \caption{Configuration parameters for the simulation}
    \centering
    \begin{tabular}{lcccc}
    \toprule
      Number & Regime  & WS & Ramp length \\ 
       & & $\left[\si{\meter\per\second}\right]$ & $\left[\si{\second}\right]$ \\ \midrule       
       I & Below & 4-10 & 200  \\
       II & Below $\rightarrow$ above rated & 10-14 & 200 \\
       III & Above & 14-20 & 200  \\
       \bottomrule
    \end{tabular}
    \label{tab:simulation_config}
\end{table}

In the Simulink options the solver is set to use a fix step time of $\Delta_t=0.001 \left[\si{\second}\right]$.

An interesting post-process check can be done on the powers, in particular one can check that the power provided by the wind is equal to the sum between the one processed by the generator, the one stored in the inertia and the one lost in the damping. In particular the power equations to the rotor side of the transmission can be written starting from \ref{eq:mech_eq}:
\begin{gather}
    J_{eq}\dot{\omega^{R}} = T_R^R - T_G^R-B_{eq}\omega_R\\
    J_{eq}\dot{\omega^{R}} + T_G^R + B_{eq}\omega^R = T_R^R\\
    \left(J_{eq}\dot{\omega^{R}} + T_G^R + B_{eq}\omega^R\right)\dot{\omega^R} = \left(T_R^R\right)\dot{\omega^R}\\
    J_{eq}\dot{\omega^{R}}^2 + T_G^R\dot{\omega^R} + B_{eq}\omega^R\dot{\omega^R} = T_R^R\dot{\omega^R}\\
    P_{inertia} + P_{generator} + P_{damping} = P_{rotor} 
    \label{eq:power_balance}
\end{gather}

\subsubsection{Simulation results}
The results of the simulations are reported in \autoref{fig:simulation_1}, \ref{fig:simulation_2}, \ref{fig:simulation_3}. \\
In particular, the figure a) reports the wind velocity as function of the simulation time. b), c), and d) are the parametrizations of the rotor rotational speed, the power, and the pitch angle as function of the wind speed. e) is the power check, as described in \autoref{eq:power_balance}. Finally, f) is the torque that the controller imposes at the generator as function of the rotor rotational speed. 
% plots of the results
\include{c_basic_model_results}

The generator power exceeds the rated one in the cases when the \acrshort{WS} exceeds the rated one. \textcolor{red}{Explain the motivations}\\


\subsubsection[]{Disabling of the pitch angle gain scheduling}
In order to verify the effect of the gain scheduling with respect a fixed gain for the pitch angle controller, two constant values are replaced instead of the polynomial gains. In particular, the value $k_p=2 \ \mesunt{\second}$ and $k_i=0.9 \left[-\right]$ are chosen since they are close to the gains at low pitch where the turbine is expected to work for more time.  

\subsection{Simulation with generated wind time series}\label{sec:wind_series_sim}
\subsubsection{Simulation settings}
The model is tested with an input wind time series. In particular, the simulation is run three times, the first with mean \acrshort{WS} of 6 $\left[\si{\meter\per\second}\right]$, the second with  11 $\left[\si{\meter\per\second}\right]$, and the third with 20. These values are chosen to test the simulator in the three characteristics wind regimes. In the first simulation the turbulence is chosen to be $\sigma=0.6 \mesunt{\meter\per\second}$ while for the other $\sigma=1 \mesunt{\meter\per\second}$. The simulation is run for $t=150\ \mesunt{\second}$ and the results of the last 100 $\mesunt{\second}$ are plotted in order to get rid of the transient behaviour. The sampling frequency for the wind series generation is set to be $f_s=50 \left[\si{\hertz}\right]$.

\subsubsection{Simulation results}
The results of this simulation are reported in \autoref{fig:simulation_rand_wind_NPC}, where the wind series and the parametrizations in time of some quantities are reported. Since in the plots the initial transient dynamic is removed, the expected results of the parametrization in case of zero turbulence is that the simulations results perfectly follow the static behaviour. Since a certain turbulence is included in the picture, then the expected results are some groups of points centred around the static curve.
\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_52_01fig_wind_TS.eps}
    \caption{Wind time series}
    \label{fig:2023_05_1_00_55_48fig_wind_TS.eps}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_39_46fig_pitch_param.eps}
    \caption{Pitch angle time series}
    \label{fig:2023_05_1_00_50_19fig_power_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_40_32fig_omega_param.eps}
    \caption{Power}
    \label{fig:2023_05_1_00_51_17fig_omega_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_3_17_40_32fig_omega_param.eps}
    \caption{Rotational speed}
    \label{fig:2023_05_1_00_50_58fig_pitch_param}
  \end{subfigure}
  \caption{Results of simulation with a generated wind series}
  \label{fig:simulation_rand_wind_NPC}
\end{figure}


\begin{figure}[htb]
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_19fig_wind_TS.eps}
    \caption{Wind time series}
    \label{fig:2023_05_8_22_43_35fig_wind_TS.eps}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_46fig_pitch_param.eps}
    \caption{Pitch angle time series}
    \label{fig:2023_05_8_22_44_05fig_pitch_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_24fig_power_param.eps}
    \caption{Power}
    \label{fig:2023_05_8_22_44_15fig_power_param}
  \end{subfigure}
  \begin{subfigure}{0.5\columnwidth}
    \centering
    \includegraphics[width = \columnwidth]{images/vectorial/2023_05_8_23_17_57fig_omega_param.eps}
    \caption{Rotational speed}
    \label{fig:2023_05_1_00_50_58fig_pitch_param}
  \end{subfigure}
  \caption{Results of simulation with a generated wind series}
  \label{fig:simulation_rand_wind_NPC}
\end{figure}
